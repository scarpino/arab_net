load("~/Research/Brachy/2010 RIL Project/Mapping/2015/Analyses/Final 1D 12.4.15.RData")
summary(lod1delta_diff)
summary(lod1C_mean)
library(qtl)
summary(lod1delta_diff)
plot(lod1delta_mean,col=c("green"))
plot(lod1delta_mean,col=c("black"))
lod1Leaf_mean=scanone(Final_data, pheno.col=27, model=c("normal"), method=c("hk"))
Maxlod1Leaf_mean=scanone(Final_data, pheno.col=27, model=c("normal"), method=c("hk"),n.perm=1000)
summary(Maxlod1Leaf_mean, alpha=0.1)
summary(lod1Leaf_mean,threshold=2.59)
summary(lod1Phenolic_mean)
summary(lod1Phenolic_diff)
lod1Biomass_dry=scanone(Final_data, pheno.col=21, model=c("normal"), method=c("hk"))
Maxlod1Biomass_dry=scanone(Final_data, pheno.col=21, model=c("normal"), method=c("hk"),n.perm=1000)
summary(Maxlod1Biomass_dry, alpha=0.1)
summary(lod1Biomass_dry,threshold=2.6)
summary(lod1Biomass_mean)
summary(lod1Biomass_diff)
load("~/Research/Brachy/2010 RIL Project/Mapping/2015/Analyses/Final 2D scans.RData")
delta_meanSW<-stepwiseqtl(Final_data, pheno.col=7, max.qtl=5, method="hk", penalties=c(2.864246, 3.79204, 1.782031), keeplodprofile = TRUE, keeptrace = TRUE)
summary(delta_meanSW)
library(qtl)
require(snow)
require(rlecuyer)
delta_meanSW<-stepwiseqtl(Final_data, pheno.col=7, max.qtl=5, method="hk", penalties=c(2.864246, 3.79204, 1.782031), keeplodprofile = TRUE, keeptrace = TRUE)
delta_diffSW<-stepwiseqtl(Final_data, pheno.col=8, max.qtl=5, method="hk", penalties=c(2.910506, 3.66652, 1.641844), keeplodprofile = TRUE, keeptrace = TRUE)
leafC_meanSW<-stepwiseqtl(Final_data, pheno.col=11, max.qtl=5, method="hk", penalties=c(2.95365, 3.651255, 1.637058), keeplodprofile = TRUE, keeptrace = TRUE)
leafC_diffSW<-stepwiseqtl(Final_data, pheno.col=12, max.qtl=5, method="hk", penalties=c(2.709706, 6.870161, 6.442045), keeplodprofile = TRUE, keeptrace = TRUE)
leafN_meanSW<-stepwiseqtl(Final_data, pheno.col=15, max.qtl=5, method="hk", penalties=c(3.00657, 4.42981, 3.025359), keeplodprofile = TRUE, keeptrace = TRUE)
leafN_diffSW<-stepwiseqtl(Final_data, pheno.col=16, max.qtl=5, method="hk", penalties=c(2.746643, 8.898944, 8.857974), keeplodprofile = TRUE, keeptrace = TRUE)
cp_meanSW<-stepwiseqtl(Final_data, pheno.col=19, max.qtl=5, method="hk", penalties=c(2.834724, 3.767848, 1.835182), keeplodprofile = TRUE, keeptrace = TRUE)
cp_diffSW<-stepwiseqtl(Final_data, pheno.col=20, max.qtl=5, method="hk", penalties=c(2.949881, 3.666679, 1.669869), keeplodprofile = TRUE, keeptrace = TRUE)
biomass_meanSW<-stepwiseqtl(Final_data, pheno.col=23, max.qtl=5, method="hk", penalties=c(2.911911, 3.684563, 1.706021), keeplodprofile = TRUE, keeptrace = TRUE)
biomass_diffSW<-stepwiseqtl(Final_data, pheno.col=24, max.qtl=5, method="hk", penalties=c(2.951124, 3.83495, 2.151503), keeplodprofile = TRUE, keeptrace = TRUE)
leaves_meanSW<-stepwiseqtl(Final_data, pheno.col=27, max.qtl=5, method="hk", penalties=c(2.984737, 3.895935, 2.020314), keeplodprofile = TRUE, keeptrace = TRUE)
leaves_diffSW<-stepwiseqtl(Final_data, pheno.col=28, max.qtl=5, method="hk", penalties=c(2.878702, 4.397682, 3.528268), keeplodprofile = TRUE, keeptrace = TRUE)
phenolic_meanSW<-stepwiseqtl(Final_data, pheno.col=31, max.qtl=5, method="hk", penalties=c(2.939211, 3.862298, 2.076231), keeplodprofile = TRUE, keeptrace = TRUE)
phenolic_diffSW<-stepwiseqtl(Final_data, pheno.col=32, max.qtl=5, method="hk", penalties=c(2.846643, 4.27912, 2.937167), keeplodprofile = TRUE, keeptrace = TRUE)
summary(delta_meanSW)
summary(delta_diffSW)
summary(leafC_meanSW)
summary(leafC_diffSW)
summary(leafN_meanSW)
summary(leafN_diffSW)
summary(cp_meanSW)
summary(cp_diffSW)
summary(biomass_meanSW)
summary(biomass_diffSW)
summary(leaves_meanSW)
summary(leaves_diffSW)
summary(phenolic_meanSW)
summary(phenolic_diffSW)
save.image("~/Research/Brachy/2010 RIL Project/Mapping/2015/Analyses/Final 2D scans.RData")
library(qtl)
load("~/Research/Brachy/2010 RIL Project/Mapping/2015/Analyses/Final 2D scans.RData")
plotLodProfile(lod2delta_mean)
plotLodProfile(delta_meanSW)
plotModel(delta_meanSW)
effectplot(Final_data, pheno.col=7, 5@74.3,)
effectplot(Final_data, pheno.col=7, mname=5@74.3,)
effectplot(Final_data, pheno.col=7, mname="5@74.3")
effectplot(Final_data, pheno.col=7, mname=5@74.3)
effectplot(Final_data, pheno.col=7, mname1="5@74.3")
effectplot(Final_data, pheno.col=7, mname1="5@74.3",mname2="2@188.4")
delta5effect<-effectplot(Final_data, pheno.col=7, mname1="5@74.3")
delta5effect
delta2.1effect<-effectplot(Final_data, pheno.col=7, mname1="2@163.51")
delta2.1effect
delta2.2effect<-effectplot(Final_data, pheno.col=7, mname1="2@188.4")
delta2.2effect
delta3effect<-effectplot(Final_data, pheno.col = 7, mname1="3@120.3")
delta3effect
leafCeffect<-effectplot(Final_data, pheno.col = 12, mname="1@178")
leafCeffect<-effectplot(Final_data, pheno.col = 12, mname1="1@178")
leafCeffect
leafCwet<-effectplot(Final_data, pheno.col = 9, mname1="1@178")
leafCdry<-effectplot(Final_data, pheno.col = 9, mname1="1@178")
leafCwet<-effectplot(Final_data, pheno.col = 9, mname1="1@178")
leafCwet<-effectplot(Final_data, pheno.col = 10, mname1="1@178")
leafCdry
leafCwet
biomass2effect<-effectplot(Final_data, pheno.col = 23, mname1="2@89.858")
biomass2effect
result.full(delta_meanSW)
delta_meanSW
load("~/Research/Brachy/2010 RIL Project/Mapping/2015/Analyses/Final 1D scans.RData")
library(qtl)
load("~/Research/Brachy/2010 RIL Project/Mapping/2015/Analyses/Final 2D scans.RData")
find.marker(Final_data, 2, 163.51)
find.marker(Final_data, 2, 163.5)
find.marker(Final_data, 2, 188.445)
find.marker(Final_data, 3, 120.274)
find.marker(Final_data, 5, 74.339)
find.marker(Final_data, 1, 178)
find.marker(Final_data, 2, 89)
delta_mean_fitlod<-fitqtl(Final_data, pheno.col=5, delta_meanSW, formula=y ~ Q1 + Q2 + Q3 + Q4 + Q2:Q4, method="hk")
summary(delta_mean_fitlod)
delta_mean_fitlod<-fitqtl(Final_data, pheno.col=7, delta_meanSW, formula=y ~ Q1 + Q2 + Q3 + Q4 + Q2:Q4, method="hk")
summary(delta_mean_fitlod)
leafC_diff_fitlod<-fitqtl(Final_data, pheno.col=12, leafC_diffSW, formula=y~Q1, method="hk")
summary(leafC_diff_fitlod)
biomass_mean_fitlod<-fitqtl(Final_data, pheno.col=23, biomass2effect, formula=y~Q1, method="hk")
biomass_mean_fitlod<-fitqtl(Final_data, pheno.col=23, biomass_meanSW, formula=y~Q1, method="hk")
summary(biomass_mean_fitlod)
delta_mean_fitlod<-fitqtl(Final_data, pheno.col=7, delta_meanSW, formula=y ~ Q1 + Q2 + Q3 + Q4 + Q2:Q4, method="hk", get.ests = TRUE)
summary(delta_mean_fitlod)
delta5x2.2effect<-effectplot(Final_data, pheno.col=7, mname1="188.445", mname2="5@74.339")
delta5x2.2effect<-effectplot(Final_data, pheno.col=7, mname1="2@188.445", mname2="5@74.339")
delta5x2.2effect
load("~/Research/Brachy/2010 RIL Project/Mapping/2015/Analyses/Final 2D scans.RData")
library(qtl)
lodint(lod2delta_mean,chr=2,drop=1.5)
lodint(delta_meanSW,chr=2,drop=1.5)
refined_biomass<-refineqtl(Final_data, pheno.col = 23, biomass_meanSW, formula=y~Q1, method="hk")
lodint(refined_biomass,chr=2, drop=1.5)
refined_delta<-refineqtl(Final_data, pheno.col = 7, delta_meanSW, formula=y ~ Q1 + Q2 + Q3 + Q4 + Q2:Q4, method="hk")
lodint(refined_delta,chr = 2)
lodint(refined_delta,chr = 2, drop = 1.5)
lodint(refined_delta,chr = 2, pos=163.5101 ,drop = 1.5)
lodint(refined_delta,chr = 3, drop = 1.5)
refined_delta2.1<-refineqtl(Final_data, pheno.col = 7, chr=2, pos=163.5101, formula=y ~ Q1 + Q2 + Q3 + Q4 + Q2:Q4, method="hk")
refined_delta2.1<-refineqtl(Final_data, pheno.col = 7, chr=2, pos=163.5101, method="hk")
lodint(refined_delta2.1, drop = 1.5)
refined_delta<-refineqtl(Final_data, pheno.col=7, chr=c(2,2,3,5), pos=c(163.51,188.445,120.274,74.339), qtl.name=c(delta2.1, delta2.2, delta3, delta5), method="hk")
refined_delta<-refineqtl(Final_data, pheno.col=7, chr=c(2,2,3,5), pos=c(163.51,188.445,120.274,74.339), qtl.name=c("delta2.1", "delta2.2", "delta3", "delta5"), method="hk")
lodint(refined_delta,chr=2, pos=163.51)
lodint(refined_delta,chr=2, qtl.index=163.51)
lodint(refined_delta,chr=2, qtl.index=163.51,drop = 1.5)
lodint(refined_delta,chr=2, qtl.index=1,drop = 1.5)
lodint(refined_delta,chr=2, qtl.index=2,drop = 1.5)
lodint(refined_delta,chr=3, qtl.index=2,drop = 1.5)
lodint(refined_delta,chr=3, qtl.index=1,drop = 1.5)
lodint(refined_delta,chr=3, qtl.index=3,drop = 1.5)
lodint(refined_delta,chr=5, qtl.index=4,drop = 1.5)
lodint(refined_delta, qtl.name="delta2.2")
lodint(refined_delta, qtl.index=2,drop = 1.5)
lodint(refined_delta, qtl.index=1,drop = 1.5)
lodint(refined_delta, qtl.index=1,drop = 1.5)
lodint(refined_delta, qtl.index=2,drop = 1.5)
lodint(refined_delta, qtl.index=3,drop = 1.5)
lodint(refined_delta, qtl.index=4,drop = 1.5)
refined_leafC<-refineqtl(Final_data, pheno.col=12, leafC_diffSW, formula=y~Q1, method="hk")
lodint(refined_leafC, chr=1,drop=1.5)
refined_delta_v2<-refineqtl(Final_data, pheno.col=7, delta_meanSW, formula=y ~ Q1 + Q2 + Q3 + Q4 + Q2:Q4, method="hk")
refined_delta<-refineqtl(Final_data, pheno.col=7, delta_meanSW, formula=y ~ Q1 + Q2 + Q3 + Q4 + Q2:Q4, method="hk")
lodint(refined_delta, qtl.index=1,drop = 1.5)
lodint(refined_delta, qtl.index=2,drop = 1.5)
lodint(refined_delta, qtl.index=3,drop = 1.5)
lodint(refined_delta, qtl.index=4,drop = 1.5)
save.image("~/Research/Brachy/2010 RIL Project/Mapping/2015/Analyses/Final 2D scans.RData")
load("~/Research/Brachy/2010 RIL Project/Mapping/2015/Analyses/Final 2D scans.RData")
install.packages("DESeq2")
source("https://bioconductor.org/biocLite.R")
biocLite("DESeq2")
library("nlme", lib.loc="/Library/Frameworks/R.framework/Versions/3.2/Resources/library")
library(DESeq2)
library(DESeq2)
library(DESeq2)
browseVignettes()
source("http://bioconductor.org/workflows.R")
workflowInstall("rnaseqGene")
library("airway")
dir<-system.file("extdata",package="airway",mustWork = TRUE)
list.files(dir)
csvfile <- file.path(dir,"sample_table.csv")
(sampleTable<-read.csv(csvfile,row.names = 1))
biocLite("GenomicAlignments")
sampleTable
file.exists(filenames)
filenames<-file.path(dir,past0(sampleTable$Run, "_subset.bam"))
filenames<-file.path(dir,paste0(sampleTable$Run, "_subset.bam"))
file.exists(filenames)
library("Rsamtools")
bamfiles<-BamFileList(filenames, yieldSize=2000000)
seqinfo(bamfiles[1])
library("GenomicFeatures")
gtffile <- file.path(dir, "Homo_sapiens.GRh37.75_subset.gtf")
(txdb <- makeTxDbFromGFF(gtffile, format="gtf", circ_seqs=character()))
gtffile <- file.path(dir, "Homo_sapiens.GRCh37.75_subset.gtf")
(txdb <- makeTxDbFromGFF(gtffile, format="gtf", circ_seqs=character()))
(ebg<-exonsBy(txdb, by="gene"))
library("BiocParallel")
register()
register(snowparam, default=TRUE)
library("GenomicAlignments")
register(MulticoreParam())
se <- summarizeOverlaps(features=ebg, reads=bamfiles,
mode="Union",
singleEnd=FALSE,
ignore.strand=TRUE,
fragments=TRUE )
se
dim(se)
asayNames(se)
assayNames(se)
head(assay(se),3)
colsums(assay(se))
colSums(assay(se))
rowRanges(se)
(colData(se)<-DataFrame(sampleTable))
save.image("~/Research/Resources/DESeq2 Trials/Bioconductor Workflow.RData")
source('~/37_lines_round2.R')
load("~/Research/Brachy/2010 RIL Project/Mapping/2015/Analyses/Final 2D scans.RData")
summary(delta_meanSW)
library(qtl)
summary(delta_meanSW)
summary(delta_meanSW0.1)
plotModel(delta_meanSW)
delta2.1effect
summary(delta_mean_fitlod)
1+1
v <- c(1,2,3)
library(DESeq2)
library(DESeq2)
setwd("~/Research/Brachy/Phenotyping/37Lines/RNASeq/Differential Expression/2016/Raw_cognate/Low counts Removed")
genotypes <- c("BdTR9K","BdTR12c","RON2")
for (curgen in genotypes){
countfile <- read.csv(paste0(curgen,"_counts.csv"), header=TRUE, row.names=1)
condfile <- read.csv(paste0(curgen, "_cond.csv"), header=TRUE, row.names=1)
dds<-DESeqDataSetFromMatrix(countfile,condfile,design=~temp + water)
dds <- dds[rowSums(counts(dds))>1,] #removes gene models with only 1 observed count across libraries
dds$water <-relevel(dds$water, ref="wet") #sets the wet treatment as the reference
print(curgen) #let's me track the progress through the genotypes
dds_DE <-DESeq(dds)
res <- results(dds_DE)
plotMA(res, main=curgen, ylim=c(-5,5))
resOrdered <- res [order(res$padj),]
file1 <- paste(curgen, "_DEresults.csv", sep = "")
write.csv(as.data.frame(resOrdered),file=file1)
rld<-rlog(dds_DE,blind = TRUE)
file2 <- paste(curgen,"_rlog.csv",sep = "")
write.csv(assay(rld),file=file2)
}
install.packages("ape")
install.packages("geiger")
install.packages("phytools")
library(ape)
library(phytools)
library(geiger)
rand_phy<-rtree(n=12)
rand_phy
plot(rand_phy)
str(rand_phy)
rand_phy$edge
rand_phy$tip.label
mini_tree<-read.tree(text = "((((A,B),C),(D,E)),F);")
plot(mini_tree)
nodelabels()
tiplabels())
tiplabels()
mini_tree$edge
rand_phy2<-rtree(n=10)
plot(rand_phy2)
nodelabels()
tiplabels()
rand_phy2<-rtree(n=12)
plot(rand_phy2)
nodelabels()
tiplabels()
rand_phy2$edge
str(rand)
str(rand_phy2)
which(rand_phy2$edge.length == max(rand_phy2$edge.length))
length(rand_phy2$tip.label)
longest_branch<-which(rand_phy2$edge.length == max(rand_phy2$edge.length))
rand_phy2$edge[longest_branch,2]<=length(rand_phy2$tip.label)
j.birds<-read.tree("http://software.rc.fas.harvard.edu/ngsdata/workshops/TENT.MP-EST.unbinned.tre")
plot(j.birds)
plot(j.birds, cex = 0.5, label.offset = 0.2)
j.birds
plot(rotate(j.birds, node=49), cex = 0.5, label.offset = 0.2)
j.birds.rot<-(rotate(j.birds,node=49),node=53)
j.birds.rot<-rotate(rotate(j.birds,node=49),node=53)
plot(j.birds.rot, cex = 0.5, label.offset = 0.2)
nodelabels(cex=0.5)
galliformes<-tips(j.birds.rot, node=51)
galliformes
birds.pruned<-drop.tip(j.birds.rot,galliformes)
plot(birds.pruned)
plot(birds.pruned,cex = 0.3)
bird.subtree <- extract.clade(j.birds.rot, node=53)
plot(bird.subtree, cex=0.5)
galliformes.node<-getMRCA(j.birds.rot, galliformes)
galliformes.node
j.birds.rot$edge.length=rep(1, length(j.birds.rot$edge[,1]))
str(j.birds.rot)
nodes_to_collapse<-which(as.numeric(j.birds.rot$node.label) < 90)+Ntip(j.birds.rot)
nodes_to_collapse
edges_to_collapse<-which(j.birds.rot$edge[,2] %in% nodes_to_collapse)
j.birds.rot$edge.length[edges_to_collapse]
j.birds.rot$edge.length[edges_to_collapse]=0
j.birds.rot$edge.length[edges_to_collapse]
j.birds.collapsed=di2multi(j.birds.rot)
j.birds.collapsed$edge.length=NULL
plot(j.birds.collapsed, cex=0.5)
is.binary.tree(j.birds.rot)
is.binary.tree(j.birds.collapsed)
landbirds<-tips(j.birds.rot, node=71)
landbirds
landbirds.node<-getMRCA(j.birds.collapsed, landbirds)
landbirds.node
landbird.subtree <- extract.clade(j.birds.collapsed, node=66)
plot(landbird.subtree, cex=0.5)
j.tent<-read.tree("http://software.rc.fas.harvard.edu/workshops/TENT.ExaML")
j.tent<-read.tree("http://software.rc.fas.harvard.edu/ngsdata/workshops/TENT.ExaML")
j.tent<-read.tree("http://software.rc.fas.harvard.edu/ngsdata/workshops/TENT.ExaML.tre")
plot(j.tent)
j.tent.root<-root(j.tent, outgroup = c("Common_ostrich","White-throated_tinamou"))
plot(j.tent.root,  cex=0.5)
add.scale.bar()
plot(j.tent.root, cex=0.5, use.edge.length = F,node.depth = 2, )
low_support_nodes=which(as.numeric(j.tent.root$node.label)<100)+Ntip(j.tent.root)
low_support_nodes
nodelabels(text=j.tent.root$node.label)
plot(j.tent.root, cex=0.5, use.edge.length = F,node.depth = 2)
nodelabels(text=j.tent.root[which(as.numeric(j.tent.root$node.label)<100)],node=low_support_nodes,)
nodelabels(text=j.tent.root$node.label[which(as.numeric(j.tent.root$node.label)<100)],node=low_support_nodes,)
plot(j.tent.root, cex=0.5, use.edge.length = F,node.depth = 2)
nodelabels(text=j.tent.root$node.label[which(as.numeric(j.tent.root$node.label)<100)],node=low_support_nodes,)
nodelabels(text=j.tent.root$node.label[which(as.numeric(j.tent.root$node.label)<100)],node=low_support_nodes, cex=0.5, frame="n")
plot(j.tent.root, cex=0.5, use.edge.length = F,node.depth = 2)
nodelabels(text=j.tent.root$node.label[which(as.numeric(j.tent.root$node.label)<100)],node=low_support_nodes, cex=0.5, frame="n")
nodelabels(text=j.tent.root$node.label[which(as.numeric(j.tent.root$node.label)<100)],node=low_support_nodes, cex=0.5, frame="n", adj = c(1.2,-0.2))
data("anoletree")
data(anoletree)
x<-getStates(anoletree, "tips")
anole_tree<-anoletree
rm(anoletree)
plot(anole_tree)
anole_tree
plot.phylo(anole_tree, type="fan", edge.color = c("black"), cex=0.6)
col<-setNames(pallette()[1:length(unique())],sort(unique(x))
)
col<-setNames(palette()[1:length(unique())],sort(unique(x)))
col<-setNames(palette()[1:length(unique(x))],sort(unique(x)))
tiplabels(pie=to.matrix(x,sort(unique(x))))
tiplabels(pie=to.matrix(x,sort(unique(x))), piecol = col, cex=0.6)
plot.phylo(anole_tree, type="fan", edge.color = c("black"), cex=0.6)
col<-setNames(palette()[1:length(unique(x))],sort(unique(x)))
tiplabels(pie=to.matrix(x,sort(unique(x))), piecol = col, cex=0.6)
fitER<-ace(x,anole_tree,model = "ER", type="discrete")
fitER
anc.lik.rounded<-round(fitER$lik.anc, 3)
head(anc.lik.rounded)
nodelabels(node=1:anole_tree$Nnode+Ntip(anole_tree),pie = anc.lik.rounded, piecol = col, cex=0.4)
install.packages("WGCNA")
source("http://bioconductor.org/biocLite.R")
?BiocUpgrade
biocLite("BiocUpgrade")
biocLite(c("AnnotationDbi", "impute", "GO.db", "preprocessCore"))
install.packages("WGCNA")
dat <- read.csv("spring_moat.csv")
setwd("~/Dropbox/arab/New Analyses 2.2017/G&E")
dat <- read.csv("spring_moat.csv")
